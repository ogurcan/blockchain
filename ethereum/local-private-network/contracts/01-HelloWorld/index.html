<!DOCTYPE html>
<!-- saved from url=(0022)http://localhost:6419/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>README.md - Grip</title>
  <link rel="icon" href="http://localhost:6419/__/grip/static/favicon.ico">
  <link rel="stylesheet" href="./index_files/frameworks-5b61aadc846f0818981ceec31b49c475fb084c163fdec5efbc2c21ef539092a9.css">
  <link rel="stylesheet" href="./index_files/github-9e591dcc1f30d2a6ac3773da2f8c05987a4a148bae15713c4be9bb62b6e92b26.css">
  <link rel="stylesheet" href="./index_files/site-f4fa6ace91e5f0fabb47e8405e5ecf6a9815949cd3958338f6578e626cd443d7.css">
  <link rel="stylesheet" href="./index_files/octicons.css">
  <style>
    /* Page tweaks */
    .preview-page {
      margin-top: 64px;
    }
    /* User-content tweaks */
    .timeline-comment-wrapper > .timeline-comment:after,
    .timeline-comment-wrapper > .timeline-comment:before {
      content: none;
    }
    /* User-content overrides */
    .discussion-timeline.wide {
      width: 920px;
    }
  </style>
</head>
<body>
  <div class="page">
    <div id="preview-page" class="preview-page" data-autorefresh-url="/__/grip/refresh/">

    

      <div role="main" class="main-content">
        <div class="container new-discussion-timeline experiment-repo-nav">
          <div class="repository-content">
            <div id="readme" class="readme boxed-group clearfix announce instapaper_body md">
              
                <h3>
                  <span class="octicon octicon-book"></span>
                  README.md
                </h3>
              
              <article class="markdown-body entry-content" itemprop="text" id="grip-content">
                <h1>
<a id="user-content-creating-deploying-and-using-a-contract" class="anchor" href="http://localhost:6419/#creating-deploying-and-using-a-contract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating, Deploying and Using a Contract</h1>

<blockquote>
<p>This example is a continuation of the <a href="http://localhost:6419//README.md">Setting Up a Local Private Test Network with One Node</a> example.</p>
</blockquote>

<h2>
<a id="user-content-before-you-begin" class="anchor" href="http://localhost:6419/#before-you-begin" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Before you begin</h2>

<p>Before you begin, make sure that the <a href="http://solidity.readthedocs.io/en/develop/index.html">Solidity</a> compiler is installed as described <a href="https://github.com/ethereum/go-ethereum/wiki/Contract-Tutorial#install-solc-on-ubuntu">here</a>. To verify if Solidy is installed correctly, go to the geth console and type the <code>eth.getCompilers()</code> command. </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&gt;</span> <span class="pl-smi">eth</span>.<span class="pl-en">getCompilers</span>()
[<span class="pl-s"><span class="pl-pds">"</span>Solidity<span class="pl-pds">"</span></span>]
<span class="pl-k">&gt;</span> </pre></div>

<p>This example is prepared by using the geth version <code>1.5.7-stable</code> which is using Go version <code>go1.7.4</code> and tested on <code>Ubuntu 14.04.5</code>. </p>

<div class="highlight highlight-source-shell"><pre>Geth
Version: 1.5.7-stable
Git Commit: da2a22c384a9b621ec853fe4b1aa651d606cf42b
Protocol Versions: [63 62]
Network Id: 1
Go Version: go1.7.4
OS: darwin
GOPATH=
GOROOT=/usr/local/Cellar/go/1.7.4_2/libexec</pre></div>

<h2>
<a id="user-content-introduction" class="anchor" href="http://localhost:6419/#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h2>

<p>Ethereum contracts are account holding objects on the ethereum blockchain. They contain code functions and can interact with other contracts, make decisions, store data, and send ether to others. Contracts are defined by their creators, but their execution, and by extension the services they offer, is provided by the ethereum network itself. They will exist and be executable as long as the whole network exists, and will only disappear if they were programmed to self destruct.</p>

<p>In this example, we will create, deploy and use a simple <code>HelloWorld</code> contract. Even though it looks very simple, you will learn several important details by this example.</p>

<h2>
<a id="user-content-contract-hello-world" class="anchor" href="http://localhost:6419/#contract-hello-world" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contract: Hello World!</h2>

<p>We will build a <code>Hello World!</code> contract on the ethereum command line. When executed, this contract is going to print out <code>HelloWorld</code> to the console.</p>

<h3>
<a id="user-content-creating-the-contract" class="anchor" href="http://localhost:6419/#creating-the-contract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating the Contract</h3>

<p>For creating contracts, you need an editor. For instance, we will use <code>nano</code> but then we will switch to a more sophisticated editor that has highlighting capability for Solidy, like using <a href="https://github.com/ethereum/emacs-solidity#emacs-solidity-mode">Emacs</a> with Solidity mode or using <a href="http://www.vim.org/">Vim</a> with a <a href="https://github.com/tomlion/vim-solidity/">Solidity syntax file</a> or using <a href="https://code.visualstudio.com/Download">Visual Studio Code</a>  with the Solidity plugin.</p>

<p>Let's create our first contract as:</p>

<div class="highlight highlight-source-shell"><pre>$ nano HelloWorld.sol</pre></div>

<p>Paste the Solidity code below inside <code>HelloWorld.sol</code>, save and exit.</p>

<div class="highlight highlight-source-js"><pre>pragma solidity <span class="pl-k">^</span><span class="pl-c1">0.4</span>.<span class="pl-ii">9</span>;
contract HelloWorld {
    <span class="pl-c">/* define variable of the type string */</span>
    string message;

    <span class="pl-c">/* this runs when the contract is executed */</span>
    <span class="pl-k">function</span> <span class="pl-en">HelloWorld</span>() public {
        message <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>HelloWorld<span class="pl-pds">"</span></span>;
    }

    <span class="pl-c">/* main function */</span>
    <span class="pl-k">function</span> <span class="pl-en">sayHello</span>() constant returns (string) {
        <span class="pl-k">return</span> message;
    }
}</pre></div>

<h3>
<a id="user-content-compiling-the-contract" class="anchor" href="http://localhost:6419/#compiling-the-contract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Compiling the Contract</h3>

<p>Contracts can be compiled either using an online compiler or an offline compiler.</p>

<h4>
<a id="user-content-online-compiling" class="anchor" href="http://localhost:6419/#online-compiling" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Online Compiling</h4>

<p>If you do not have the Solidity compiler <code>solc</code> installed, you can simply use the <a href="https://ethereum.github.io/browser-solidity/">online Solidity compiler</a>. On the online compiler, create a new file <code>HelloWorld.sol</code> and then copy the source code above into this file. After a second, the compiled code should appear on the right pane. </p>

<p>Now go back to the terminal window and create a <code>deploy.js</code> file.</p>

<div class="highlight highlight-source-shell"><pre>$ nano deploy.js</pre></div>

<p>And then go back to the online compiler and copy the code in the box labeled <code>Web3 deploy</code> into <code>deploy.js</code>.</p>

<div class="highlight highlight-source-shell"><pre>var helloworld_sol_helloworldContract = web3.eth.contract([{<span class="pl-s"><span class="pl-pds">"</span>constant<span class="pl-pds">"</span></span>:true,<span class="pl-s"><span class="pl-pds">"</span>inputs<span class="pl-pds">"</span></span>:[],<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>sayHello<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>outputs<span class="pl-pds">"</span></span>:[{<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>string<span class="pl-pds">"</span></span>}],<span class="pl-s"><span class="pl-pds">"</span>payable<span class="pl-pds">"</span></span>:false,<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>function<span class="pl-pds">"</span></span>},{<span class="pl-s"><span class="pl-pds">"</span>inputs<span class="pl-pds">"</span></span>:[],<span class="pl-s"><span class="pl-pds">"</span>payable<span class="pl-pds">"</span></span>:false,<span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>constructor<span class="pl-pds">"</span></span>}])<span class="pl-k">;</span>
var helloworld_sol_helloworld = helloworld_sol_helloworldContract.new(
   {
     from: web3.eth.accounts[0], 
     data: '0x6060604052341561000c57fe5b5b604060405190810160405280600a81526020017f48656c6c6f576f726c640000000000000000000000000000000000000000000081525060009080519060200190610059929190610060565b505b610105565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106100a157805160ff19168380011785556100cf565b828001600101855582156100cf579182015b828111156100ce5782518255916020019190600101906100b3565b5b5090506100dc91906100e0565b5090565b61010291905b808211156100fe5760008160009055506001016100e6565b5090565b90565b6101bd806101146000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063ef5fb05b1461003b575bfe5b341561004357fe5b61004b6100d4565b604051808060200182810382528381815181526020019150805190602001908083836000831461009a575b80518252602083111561009a57602082019150602081019050602083039250610076565b505050905090810190601f1680156100c65780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6100dc61017d565b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156101725780601f1061014757610100808354040283529160200191610172565b820191906000526020600020905b81548152906001019060200180831161015557829003601f168201915b505050505090505b90565b6020604051908101604052806000815250905600a165627a7a72305820a96c132424b791c602e66b9b217ed288c635c144a667749f26910a38166ce5fe0029', 
     gas: <span class="pl-s"><span class="pl-pds">'</span>4700000<span class="pl-pds">'</span></span>
   }, <span class="pl-k">function</span> <span class="pl-en">(e,</span> contract){
    console.log(e, contract)<span class="pl-k">;</span>
    <span class="pl-k">if</span> (typeof contract.address <span class="pl-k">!</span>== <span class="pl-s"><span class="pl-pds">'</span>undefined<span class="pl-pds">'</span></span>) {
         console.log(<span class="pl-s"><span class="pl-pds">'</span>Contract mined! address: <span class="pl-pds">'</span></span> + contract.address + <span class="pl-s"><span class="pl-pds">'</span> transactionHash: <span class="pl-pds">'</span></span> + contract.transactionHash)<span class="pl-k">;</span>
    }
 })</pre></div>

<h4>
<a id="user-content-offline-compiling" class="anchor" href="http://localhost:6419/#offline-compiling" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Offline Compiling</h4>

<p>Offline compiling will be explained after.</p>

<h3>
<a id="user-content-deploying-the-contract" class="anchor" href="http://localhost:6419/#deploying-the-contract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Deploying the Contract</h3>

<p>To deploy the HelloWorld contract, we need to go back to the geth JavaScript console execute. If you check again the compiled code above, you will see that by default the compiler is adding <code>from: web3.eth.accounts[0]</code> because this is the address from which we are deploying
i.e. the account that pays for the deploy costs. In this sense, if this account is locked, first we need to unlock it. </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&gt;</span> <span class="pl-smi">personal</span>.<span class="pl-en">unlockAccount</span>(<span class="pl-smi">eth</span>.<span class="pl-smi">accounts</span>[<span class="pl-c1">0</span>],<span class="pl-s"><span class="pl-pds">"</span>Node01Account00<span class="pl-pds">"</span></span>)
<span class="pl-c1">true</span>
<span class="pl-k">&gt;</span> </pre></div>

<p>After unlocking the account, we can deploy the contract by using the <code>loadScript()</code> command. However, to see how much we pay for the deployment, check the balance of this account first. Note that, if this is the mining account, you will not be able to easily see that the balance goes down since it will increase again in a few seconds.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&gt;</span> <span class="pl-smi">web3</span>.<span class="pl-en">fromWei</span>(<span class="pl-smi">eth</span>.<span class="pl-en">getBalance</span>(<span class="pl-smi">eth</span>.<span class="pl-smi">accounts</span>[<span class="pl-c1">0</span>]), <span class="pl-s"><span class="pl-pds">"</span>ether<span class="pl-pds">"</span></span>)
<span class="pl-c1">15.55916000</span>
<span class="pl-k">&gt;</span> </pre></div>

<p>Then deploy the contract.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&gt;</span> <span class="pl-en">loadScript</span>(<span class="pl-s"><span class="pl-pds">"</span>deploy.js<span class="pl-pds">"</span></span>)
<span class="pl-c1">null</span> [object <span class="pl-c1">Object</span>]
<span class="pl-c1">true</span>
<span class="pl-k">&gt;</span> <span class="pl-c1">null</span> [object <span class="pl-c1">Object</span>]
Contract mined<span class="pl-k">!</span> address<span class="pl-k">:</span> <span class="pl-c1">0xdaa915dc454a3dea4e0030c7ec47bf3195591a97</span> transactionHash<span class="pl-k">:</span> <span class="pl-c1">0x6ffb8e69dd7ec29cbcc575fdfd578dc067b1c5ae592c32574125359024c7baca</span>
<span class="pl-k">&gt;</span></pre></div>

<p>You should wait until you see the <code>Contract mined</code> message and then check the balance again.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&gt;</span> <span class="pl-smi">web3</span>.<span class="pl-en">fromWei</span>(<span class="pl-smi">eth</span>.<span class="pl-en">getBalance</span>(<span class="pl-smi">eth</span>.<span class="pl-smi">accounts</span>[<span class="pl-c1">0</span>]), <span class="pl-s"><span class="pl-pds">"</span>ether<span class="pl-pds">"</span></span>)
<span class="pl-c1">15.55568538</span>
<span class="pl-k">&gt;</span>  </pre></div>

<p>As you can easily see, <code>15.55916000</code> - <code>15.55568538</code> =  <code>0.00347462</code> ethers is paid by <code>Account 0</code> as a deployment cost.</p>

<h3>
<a id="user-content-using-the-contract" class="anchor" href="http://localhost:6419/#using-the-contract" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Using the Contract</h3>

<p>Now we can use the deployed contract by calling the <code>sayHello()</code> method. However, to see that </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&gt;</span> <span class="pl-smi">helloworld_sol_helloworld</span>.<span class="pl-en">sayHello</span>()
<span class="pl-s"><span class="pl-pds">"</span>HelloWorld<span class="pl-pds">"</span></span>
<span class="pl-k">&gt;</span></pre></div>

<p>As you can verify also, no cost is paid for the usage of the contract.</p>

<h2>
<a id="user-content-what-is-next" class="anchor" href="http://localhost:6419/#what-is-next" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What is next?</h2>

<p>You learned about the very basics of the contracts. Now it is time to into a bit more details. You can continue to the <a href="http://localhost:6419/ReceiveEther/README.md">Receiving Ethers Using a Contract</a> example.</p>

              </article>
            </div>
          </div>
        </div>
      </div>

    

  </div>
  <div>&nbsp;</div>
  </div><script>
    function showCanonicalImages() {
      var images = document.getElementsByTagName('img');
      if (!images) {
        return;
      }
      for (var index = 0; index < images.length; index++) {
        var image = images[index];
        if (image.getAttribute('data-canonical-src') && image.src !== image.getAttribute('data-canonical-src')) {
          image.src = image.getAttribute('data-canonical-src');
        }
      }
    }

    function scrollToHash() {
      if (location.hash && !document.querySelector(':target')) {
        var element = document.getElementById('user-content-' + location.hash.slice(1));
        if (element) {
           element.scrollIntoView();
        }
      }
    }

    function autorefreshContent(eventSourceUrl) {
      var initialTitle = document.title;
      var contentElement = document.getElementById('grip-content');
      var source = new EventSource(eventSourceUrl);
      var isRendering = false;

      source.onmessage = function(ev) {
        var msg = JSON.parse(ev.data);
        if (msg.updating) {
          isRendering = true;
          document.title = '(Rendering) ' + document.title;
        } else {
          isRendering = false;
          document.title = initialTitle;
          contentElement.innerHTML = msg.content;
          showCanonicalImages();
        }
      }

      source.onerror = function(e) {
        if (e.readyState === EventSource.CLOSED && isRendering) {
          isRendering = false;
          document.title = initialTitle;
        }
      }
    }

    window.onhashchange = function() {
      scrollToHash();
    }

    window.onload = function() {
      scrollToHash();
    }

    showCanonicalImages();

    var autorefreshUrl = document.getElementById('preview-page').getAttribute('data-autorefresh-url');
    if (autorefreshUrl) {
      autorefreshContent(autorefreshUrl);
    }
  </script>

</body></html>