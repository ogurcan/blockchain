// unlock all accounts
loadScript("config/UnlockAccounts.js");
// contract code
var reputationSystemContract = web3.eth.contract([{"constant":true,"inputs":[{"name":"transitionID","type":"uint256"},{"name":"stakeholderID","type":"address"}],"name":"isInsideTransition","outputs":[{"name":"result","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"transitionList","outputs":[{"name":"foodProviderID","type":"address"},{"name":"breederID","type":"address"},{"name":"animalCarrierID","type":"address"},{"name":"slaughterHouseID","type":"address"},{"name":"refrigeratedCarrierID","type":"address"},{"name":"brandID","type":"address"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"feedbacks","outputs":[{"name":"transitionID","type":"uint256"},{"name":"evaluatorID","type":"address"},{"name":"evaluatedID","type":"address"},{"name":"weight","type":"uint256"},{"name":"rate","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"name":"feedbackRelationships","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"stakeholderID","type":"address"}],"name":"getReputation","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"transitionID","type":"uint256"},{"name":"evaluatedID","type":"address"},{"name":"rate","type":"uint256"}],"name":"rate","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"foodProviderID","type":"address"},{"name":"breederID","type":"address"},{"name":"animalCarrierID","type":"address"},{"name":"slaughterHouseID","type":"address"},{"name":"refrigeratedCarrierID","type":"address"},{"name":"brandID","type":"address"}],"name":"createTransition","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"stakeholders","outputs":[{"name":"name","type":"string"},{"name":"id","type":"address"},{"name":"role","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"name","type":"string"},{"name":"role","type":"uint256"}],"name":"addStakeholder","outputs":[],"payable":false,"type":"function"},{"inputs":[],"payable":false,"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"name","type":"string"},{"indexed":false,"name":"id","type":"address"},{"indexed":false,"name":"role","type":"uint256"}],"name":"StakeholderAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"trID","type":"uint256"}],"name":"TransitionCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"transitionID","type":"uint256"},{"indexed":false,"name":"evaluatorName","type":"string"},{"indexed":false,"name":"evaluatedName","type":"string"},{"indexed":false,"name":"rate","type":"uint256"}],"name":"FeedbackGiven","type":"event"}]);
var reputationSystem = reputationSystemContract.new(
   {
     from: web3.eth.accounts[0], 
     data: '0x606060405260016004556000600655341561001657fe5b5b60008054600160a060020a03191633600160a060020a03161781557ff8dd1754cdb399bc5b4e203e4acfec383074082a262a94d223f4e1ba300eaf08805460ff1990811660019081179092557fe3676086f4a883dc16130d16abf278f5c150e68c2617fc316cdd91414d82ea7480548216831790557f9fffbb9e89029b0baa965344cab51a6b05088fdd0a0df87ecf7dddfe9e4c7b7480548216831790557f85c8d53f896f29b263aef4a7c060c9014c20977dbb5ec4ce69dbd3968de6e4d380548216831790557f7e486e43646097e9bffc9198a94f3d553a3f64a8ca16793e9c9c510c31dd515180548216831790557ff675a99de4baad6b24b8fc680370f5be1b1ef4f092c28e6a215bd988d9aaeb8280548216831790557f8d4b243c7de8cb9a30e76b986ffbec4cd784be97eca524a423b4c3e14d94070980548216831790557f11351240656473593f2158e499710d9bfaae96571680fdb7c1cd583dd95efb78805482168317905560049092527fb98b78633099fa36ed8b8680c4f8092689e1e04080eb9cbb077ca38a14d7e3846020527f8c06a63ecc6821849443ffa8d7a7f4bf62fb877f13b87df88049b6d5679030e980549092161790555b5b610e2b806101e56000396000f300606060405236156100965763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166314b946e581146100985780632965b924146100cb5780632bb8b0dc146101215780639c8430611461016b5780639c89a0e214610195578063a83b083c146101c3578063a9fcb699146101e7578063c07cfca914610223578063da9143f5146102df575bfe5b34156100a057fe5b6100b7600435600160a060020a0360243516610339565b604080519115158252519081900360200190f35b34156100d357fe5b6100de60043561047c565b60408051600160a060020a03978816815295871660208701529386168585015291851660608501528416608084015290921660a082015290519081900360c00190f35b341561012957fe5b6101346004356104c7565b60408051958652600160a060020a039485166020870152929093168483015260608401526080830191909152519081900360a00190f35b341561017357fe5b6100b7600435602435610502565b604080519115158252519081900360200190f35b341561019d57fe5b6101b1600160a060020a0360043516610522565b60408051918252519081900360200190f35b34156101cb57fe5b6101e5600435600160a060020a0360243516604435610595565b005b34156101ef57fe5b6101e5600160a060020a0360043581169060243581169060443581169060643581169060843581169060a43516610972565b005b341561022b57fe5b61023f600160a060020a0360043516610b88565b60408051600160a060020a0384166020820152908101829052606080825284546002600019610100600184161502019091160490820181905281906080820190869080156102ce5780601f106102a3576101008083540402835291602001916102ce565b820191906000526020600020905b8154815290600101906020018083116102b157829003601f168201915b505094505050505060405180910390f35b34156102e757fe5b6101e5600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437509496505093359350610bb192505050565b005b6000828152600360209081526040808320600160a060020a038516845260019092528220600281015483908190819081908190819015801561038757508754600160a060020a038b81169116145b9550866002015460011480156103ac57506001880154600160a060020a038b81169116145b9450866002015460021480156103d157506002880154600160a060020a038b81169116145b9350866002015460031480156103f657506003880154600160a060020a038b81169116145b92508660020154600414801561041b57506004880154600160a060020a038b81169116145b91508660020154600514801561044057506005880154600160a060020a038b81169116145b9050858061044b5750845b806104535750835b8061045b5750825b806104635750815b8061046b5750805b98505b505050505050505092915050565b6003602081905260009182526040909120805460018201546002830154938301546004840154600590940154600160a060020a03938416959284169492841693918216928216911686565b600560205260009081526040902080546001820154600283015460038401546004909401549293600160a060020a0392831693929091169185565b600260209081526000928352604080842090915290825290205460ff1681565b60006002600382805b60065482101561057d575060008181526005602052604090206002810154600160a060020a03878116911614156105715760038101546004820154948101940292909201915b5b60019091019061052b565b838381151561058857fe5b0494505b50505050919050565b33600160a060020a03818116600090815260016020818152604080842094881684528084208151865460029581161561010002600019011694909404601f81018490049093028401608090810190925260608401838152909493610735938b93919288928492849184018282801561064e5780601f106106235761010080835404028352916020019161064e565b820191906000526020600020905b81548152906001019060200180831161063157829003601f168201915b5050509183525050600182810154600160a060020a03166020808401919091526002938401546040938401528251895461010093811615939093026000190190921693909304601f810184900490930281016080908101909252606081018381529092889284929184918401828280156107095780601f106106de57610100808354040283529160200191610709565b820191906000526020600020905b8154815290600101906020018083116106ec57829003601f168201915b50505091835250506001820154600160a060020a03166020820152600290910154604090910152610cf2565b156109685761074384610522565b905060a06040519081016040528088815260200185600160a060020a0316815260200187600160a060020a031681526020018281526020018681525060056000600660008154809291906001019190505581526020019081526020016000206000820151816000015560208201518160010160006101000a815481600160a060020a030219169083600160a060020a0316021790555060408201518160020160006101000a815481600160a060020a030219169083600160a060020a0316021790555060608201518160030155608082015181600401559050507f06820d4bd577f2ef80b54db53e487b6d4a60838802cd04b16f3abcfae6e36f85878460000184600001886040518085815260200180602001806020018481526020018381038352868181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156108e15780601f106108b6576101008083540402835291602001916108e1565b820191906000526020600020905b8154815290600101906020018083116108c457829003601f168201915b50508381038252855460026000196101006001841615020190911604808252602090910190869080156109555780601f1061092a57610100808354040283529160200191610955565b820191906000526020600020905b81548152906001019060200180831161093857829003601f168201915b5050965050505050505060405180910390a15b5b50505050505050565b600160a060020a0386166000908152600160205260409020600201541580156109b75750600160a060020a038516600090815260016020819052604090912060020154145b80156109de5750600160a060020a0384166000908152600160205260409020600290810154145b8015610a055750600160a060020a0383166000908152600160205260409020600201546003145b8015610a2c5750600160a060020a0382166000908152600160205260409020600201546004145b8015610a535750600160a060020a0381166000908152600160205260409020600201546005145b15610b79576040805160c081018252600160a060020a0388811682528781166020808401918252888316848601908152888416606086019081528885166080870190815288861660a088019081526004805460009081526003808852908b902099518a5473ffffffffffffffffffffffffffffffffffffffff19908116918b16919091178b55975160018b0180548a16918b16919091179055945160028a0180548916918a169190911790559251938801805487169488169490941790935551868201805486169187169190911790559051600590950180549093169490931693909317905554825190815291517f07f383ef20883e5317b9eff9ac56ff7ae01bcb468961a2b99687b625c49abff29281900390910190a1600480546001019055610b7f565b60006000fd5b5b505050505050565b6001602081905260009182526040909120908101546002820154600160a060020a039091169083565b6040805160608101825283815233600160a060020a03811660208084018290528385018690526000918252600181529390208251805192949192610bf89284920190610d5f565b5060208281015160018301805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a03928316179055604093840151600290930192909255825191841682820152918101849052606080825285519082015284517ff01bcdea9ac2092dd40b3f187cd37d8a359f94945ebe051c45a05c66d796221b92869285928792829160808301918701908083838215610cb1575b805182526020831115610cb157601f199092019160209182019101610c91565b505050905090810190601f168015610cdd5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a15b505050565b6000600060006000610d08878760200151610339565b9250610d18878660200151610339565b6040808801516000908152600260209081528282208984015183529052205490925060ff169050828015610d495750815b8015610d525750805b93505b5050509392505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10610da057805160ff1916838001178555610dcd565b82800160010185558215610dcd579182015b82811115610dcd578251825591602001919060010190610db2565b5b50610dda929150610dde565b5090565b610dfc91905b80821115610dda5760008155600101610de4565b5090565b905600a165627a7a7230582023af2e5be14b363e75807c108ce1acb8f3dce7433fa8a400be02fac862101e450029', 
     gas: '4700000'
   }, function (e, contract){
    console.log(e, contract);
    if (typeof contract.address !== 'undefined') {
         console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
         // Event StakeholderAdded
      	 contract.StakeholderAdded().watch(function(error, result){
	      if (!error)
	         console.log("[" + result.args.name + " has been added as a stakeholder with the ID " + result.args.id + " and the profession number " + result.args.role + ".]");
	 });
	 // Event BusinessProcessCreated
      	 contract.BusinessProcessCreated().watch(function(error, result){
	      if (!error)
	         console.log("[The business process has been created with the ID " + result.args.trID + ".]");
	 });
	 // Event FeedbackGiven
      	 contract.FeedbackGiven().watch(function(error, result){
	      if (!error)
	         console.log("[" + result.args.evaluatorName + " has rated " + result.args.evaluatedName + " with a rate of " + result.args.rate + ".]");
	 });
    }
 })
